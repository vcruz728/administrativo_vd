import{r as i,G as z,j as e,S as I,x as h}from"./app-CfIZwGwU.js";import{A as J,p as Z}from"./pageHeader-Bkp2TYq1.js";import{$ as l,E as f,l as x,D as G}from"./es-MX-LhFyKpEo.js";import $ from"./InputError-C7Q5PRis.js";import{R as E,B as s,V as q}from"./index-BnXjDogV.js";import{V as Q}from"./VerPdf-CarIcMA9.js";import{L as U,J as X}from"./buttons.html5-B_9CvJJp.js";import{C as u}from"./Col-Qr9kuXVV.js";import{C as g}from"./Card-DKSS8lqU.js";import{T as Y,a as b}from"./Tabs-Cg0F8UWU.js";import{M as ee,a as ae,b as te,c as se,d as ie}from"./Modal-BqIKmZ-n.js";import{F as k}from"./Form-BNoJLj0G.js";import"./commonimages-B1RfzdlK.js";import"./CloseButton-Cfn6-q13.js";import"./ElementChildren-DDLPNzr_.js";window.JSZip=X;f.use(G);const Ne=({status:oe,oficios:j,nuevos:N})=>{const w=i.useRef(null),[O,p]=i.useState(!1),[D,c]=i.useState(!1),[F,y]=i.useState(!1),[n,d]=i.useState({urlPdf:"",extension:"",idOfico:0}),[R,S]=i.useState(),[V,C]=i.useState(),[P,T]=i.useState(),[A,H]=i.useState(),[L,B]=i.useState();i.useEffect(()=>{S((j||[]).filter(a=>a.archivo_respuesta===null&&a.id_area!=="1").map(a=>({...a}))),C((j||[]).filter(a=>a.archivo_respuesta!==null&&a.id_area!=="1").map(a=>({...a}))),T((j||[]).filter(a=>a.id_area==="1").map(a=>({...a})))},[j]),i.useEffect(()=>{H((N||[]).filter(a=>a.archivo_respuesta===null).map(a=>({...a}))),B((N||[]).filter(a=>a.archivo_respuesta!==null).map(a=>({...a})))},[N]);const r=z({id:0,archivo:null,tipo:""}),M=a=>{a.preventDefault(),r.post(route("subeEvidenciaRecibido"),{onSuccess:W})},K=a=>{const t=a.target;t.files&&r.setData("archivo",t.files[0])},W=()=>{r.setDefaults({id:0,archivo:null}),p(!1),r.reset(),w.current.value="",q("Correcto: Se guardo la respuesta del oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})},_=async(a,t)=>{const v=await(await fetch(route("oficios.getEstatus",{valor:a,tipo:t}),{method:"get"})).json();switch(t){case"activos":S((v.data||[]).filter(o=>o.archivo_respuesta===null&&o.id_area!=="1").map(o=>({...o})));break;case"historico_vd":C((v.data||[]).filter(o=>o.archivo_respuesta!==null&&o.id_area!=="1").map(o=>({...o})));break}};return e.jsxs(J,{children:[e.jsxs(I,{children:[e.jsx("title",{children:"Mis oficios"}),e.jsx("meta",{name:"Oficios con respuestas",content:"Lista de oficios con respuestas asignadas."})]}),e.jsxs(i.Fragment,{children:[e.jsx(Z,{titles:"Listado de oficios",active:"Listado de oficios",items:[]}),e.jsx(E,{children:e.jsx(u,{lg:12,md:12,children:e.jsxs(g,{children:[e.jsxs(g.Header,{className:"d-flex justify-content-between",children:[e.jsx(g.Title,{as:"h3",children:"Oficios con respuestas"}),e.jsxs("div",{className:"tags",children:[e.jsx("span",{className:"tag tag-radius tag-round tag-verde",children:"Se dio respuesta en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-amarillo",children:"Sin respuesta, en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-naranja",children:"Sin respuesta, fuera de tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-rojo",children:"Se dio respuesta fuera de tiempo"})]}),e.jsx("div",{className:"tags"})]}),e.jsx(g.Body,{children:e.jsx("div",{className:"panel panel-default",children:e.jsxs(Y,{defaultActiveKey:"tab1",children:[e.jsx(b,{eventKey:"tab1",title:"Activos",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:a=>_(a.target.value,"activos"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"2",children:"Sin respuesta, en tiempo"}),e.jsx("option",{value:"3",children:"Sin respuesta, fuera de tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{l("#activos-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(f,{id:"activos-table",data:R,options:{language:x,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5]}}]},columns:[{data:"id",title:"Estatus",createdCell(a,t,m,v,o){l(a).css("background",m.color),l(a).css("color",m.color)},width:"5%"},{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"area",title:"Área",width:"10%"},{data:"proceso",title:"Proceso",width:"10%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{6:(a,t)=>e.jsx("div",{className:"text-center",children:t.enviado===1?e.jsx(s,{className:"btn-icon btn btn-warning",variant:"warning",title:"Subir confirmación de recibido",onClick:()=>{r.clearErrors(),r.setData({...a,id:t.id,tipo:"respuesta"}),p(!0)},children:e.jsx("i",{className:"fa fa-upload"})}):e.jsx(h,{href:route("viewRespOficio",{id:t.id}),children:e.jsxs(s,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})})})}})]})}),e.jsx(b,{eventKey:"tab2",title:"Histórico",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:a=>_(a.target.value,"historico_vd"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{l("#historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(f,{id:"historico-table",data:V,options:{language:x,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5]}}]},columns:[{data:"id",title:"Estatus",createdCell(a,t,m,v,o){l(a).css("background",m.color),l(a).css("color",m.color)},width:"5%"},{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"area",title:"Área",width:"10%"},{data:"proceso",title:"Proceso",width:"10%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{6:(a,t)=>e.jsxs("div",{className:"text-center",children:[e.jsx(s,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...n,urlPdf:t.archivo_respuesta,extension:t.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(s,{className:"btn-icon btn btn-warning ml-1",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{d({...n,urlPdf:t.oficio_final,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(s,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{d({...n,urlPdf:t.archivo,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-eye"})}),e.jsx(s,{className:"btn-icon ml-1",variant:"success",onClick:()=>{d({...n,idOfico:t.id}),y(!0)},title:"Ver línea de tiempo del oficio",children:e.jsx("i",{className:"fa fa-history"})})]})}})]})}),e.jsx(b,{eventKey:"tab3",title:"Informativos",children:e.jsx(u,{md:12,className:"table-responsive",children:e.jsx(f,{data:P,options:{language:x,autoWidth:!1},columns:[{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{3:(a,t)=>e.jsx("div",{className:"text-center",children:e.jsx(s,{className:"btn-icon ",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{d({...n,urlPdf:t.archivo,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-eye"})})})}})})}),e.jsx(b,{eventKey:"tab4",title:"Oficios VD",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{l("#vd-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(f,{id:"vd-table",data:A,options:{language:x,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"nombre_desti",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(a,t)=>e.jsxs("div",{className:"text-center",children:[t.masivo==1?t.enviado===1?t.archivo_respuesta===null?e.jsx(s,{className:"btn-icon btn btn-warning mr-1",variant:"warning",title:"Subir confirmación de recibido",onClick:()=>{r.clearErrors(),r.setData({...a,id:t.id,tipo:"nuevo"}),p(!0)},children:e.jsx("i",{className:"fa fa-upload"})}):e.jsx(s,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...n,urlPdf:t.archivo_respuesta,extension:t.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}):null:t.enviado===1?e.jsx(h,{href:route("oficios.confirmaRecibidosNuevos",{id:t.id}),children:e.jsxs(s,{className:"btn-icon btn btn-warning mr-1",variant:"warning",title:"Confirmaciones de recibido",children:[e.jsx("i",{className:"fa fa-handshake-o"})," "]})}):null,t.enviado===null?e.jsx(h,{href:route("viewRespNuevoOficio",{id:t.id}),children:e.jsxs(s,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})}):null,e.jsx(h,{href:route("oficios.detalleNuevo",{id:t.id}),children:e.jsx(s,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})}),e.jsx(b,{eventKey:"tab5",title:"Oficios VD Histórico",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{l("#vd-historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(f,{id:"vd-historico-table",data:L,options:{language:x,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"destinatario",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(a,t)=>e.jsxs("div",{className:"text-center",children:[t.masivo==1?e.jsx(s,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...n,urlPdf:t.archivo_respuesta,extension:t.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}):e.jsx(h,{href:route("oficios.confirmaRecibidosNuevos",{id:t.id}),children:e.jsxs(s,{className:"btn-icon btn btn-warning mr-1",variant:"warning",title:"Confirmaciones de recibido",children:[e.jsx("i",{className:"fa fa-handshake-o"})," "]})}),e.jsx(h,{href:route("oficios.detalleNuevo",{id:t.id}),children:e.jsx(s,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})})]})})})]})})}),e.jsxs(ee,{show:O,onHide:()=>p(!1),children:[e.jsx(ae,{children:e.jsx(te,{as:"h5",children:"Evidencía de recibido"})}),e.jsxs("form",{onSubmit:M,children:[e.jsx(se,{children:e.jsx(E,{children:e.jsxs(u,{xs:12,children:[e.jsx(k.Label,{children:"Evidencia de confirmación de recibido:"}),e.jsx(k.Control,{type:"file",accept:".pdf,.jpg,.png,.jpeg",className:r.errors.archivo?"inputError":"",ref:w,onChange:a=>K(a)}),e.jsx($,{className:"mt-1",message:r.errors.archivo})]})})}),e.jsxs(ie,{children:[e.jsx(s,{variant:"secondary",onClick:()=>p(!1),children:"Cancelar"}),e.jsx(s,{variant:"primary",type:"submit",children:"Subir evidencia"})]})]})]}),e.jsx(Q,{urlPdf:n.urlPdf,show:D,tipo:n.extension,setShow:c}),e.jsx(U,{showLinea:F,setShowLinea:y,id:n.idOfico})]})]})};export{Ne as default};
