import{X as xe,r as t,G as K,j as e,S as be,x as f}from"./app-CfIZwGwU.js";import{A as je,p as ve}from"./pageHeader-Bkp2TYq1.js";/* empty css                     */import{$ as p,E as x,l as j,D as ge}from"./es-MX-LhFyKpEo.js";import{V as Ne}from"./VerPdf-CarIcMA9.js";import{S as W}from"./react-select.esm-BSMfPm2J.js";import w from"./InputError-C7Q5PRis.js";import{R as y,B as i,c as I}from"./index-BnXjDogV.js";import{S as _e}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{L as ye,J as Se}from"./buttons.html5-B_9CvJJp.js";import{C as l}from"./Col-Qr9kuXVV.js";import{C as S}from"./Card-DKSS8lqU.js";import{T as Ce,a as v}from"./Tabs-Cg0F8UWU.js";import{M as A,a as E,b as P,c as V,d as D}from"./Modal-BqIKmZ-n.js";import{F as C}from"./Form-BNoJLj0G.js";import"./commonimages-B1RfzdlK.js";import"./CloseButton-Cfn6-q13.js";import"./floating-ui.dom-yjPBAgC-.js";import"./ElementChildren-DDLPNzr_.js";window.JSZip=Se;x.use(ge);function $e({status:ze,oficios:g,usuariosSelect:J,procesos:$,nuevos:z}){const m=xe().props.auth.user,[U,c]=t.useState(!1),[Z,N]=t.useState(!1),[q,R]=t.useState(!1),[G,_]=t.useState(!1),[X,Q]=t.useState([]),[Y,O]=t.useState(!1),[ee,ae]=t.useState([]),[k,se]=t.useState({textoRechazo:""}),[o,d]=t.useState({urlPdf:"",extension:"",idOfico:0}),F=t.useRef(null),[ie,T]=t.useState(),[te,B]=t.useState(),[oe,ne]=t.useState(),[re,le]=t.useState(),[ce,de]=t.useState();t.useEffect(()=>{T((g||[]).filter(s=>s.archivo_respuesta===null&&s.id_area!="1").map(s=>({...s}))),B((g||[]).filter(s=>s.archivo_respuesta!==null&&s.id_area!="1").map(s=>({...s}))),ne((g||[]).filter(s=>s.id_area==="1").map(s=>({...s})))},[g]),t.useEffect(()=>{le((z||[]).filter(s=>s.archivo_respuesta===null).map(s=>({...s}))),de((z||[]).filter(s=>s.archivo_respuesta!==null).map(s=>({...s})))},[z]);const n=K({id:"",proceso_impacta:"",usuario:""}),L=s=>{s.preventDefault(),n.post(route("oficioAsignaResponsable"),{onSuccess:he})},h=K({id:0,descripcion:""}),ue=s=>{s.preventDefault(),_e.fire({title:"¿Está seguro?",text:"Se notificará al jefe de área y ya no podrá ver el oficio",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, estoy seguro",denyButtonText:"Cancelar",customClass:{container:"swalSuperior"}}).then(a=>{a.isConfirmed?h.post(route("rechazaOFicio"),{onSuccess:fe}):h.cancel()})},me=async s=>{n.clearErrors(),n.setData("id",s.id),ae($),setTimeout(()=>{F.current.setValue({value:s.proceso_impacta,label:s.proceso},"select-option")},200),N(!0)},he=()=>{n.reset(),N(!1),I("Correcto: Se asigno un responsable al oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})},fe=()=>{h.reset(),_(!1),I("Correcto: Se rechazo el oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})},H=async(s,a)=>{const b=await(await fetch(route("oficios.getArchivosAdjuntos",{id:s,tipo:a}),{method:"get"})).json();Q(b.data),R(!0)},pe=(s,a,u)=>{a==1?(d({...o,urlPdf:s,extension:u}),c(!0)):window.open(s,"_blank")},M=async(s,a)=>{const b=await(await fetch(route("oficios.getEstatus",{valor:s,tipo:a}),{method:"get"})).json();switch(a){case"activos":T((b.data||[]).filter(r=>r.archivo_respuesta===null&&r.id_area!=="1").map(r=>({...r})));break;case"historico_vd":B((b.data||[]).filter(r=>r.archivo_respuesta!==null&&r.id_area!=="1").map(r=>({...r})));break}};return e.jsxs(je,{children:[e.jsxs(be,{children:[e.jsx("title",{children:"Mis oficios"}),e.jsx("meta",{name:"listado de mis oficios asignados",content:"Lista de oficios asignados"})]}),e.jsxs(t.Fragment,{children:[e.jsx(ve,{titles:"Listado de oficios",active:"Listado de oficios",items:[]}),e.jsx(y,{children:e.jsx(l,{lg:12,md:12,children:e.jsxs(S,{children:[e.jsxs(S.Header,{className:"d-flex justify-content-between",children:[e.jsx(S.Title,{as:"h3",children:"Mis oficios asignados"}),e.jsxs("div",{className:"tags",children:[e.jsx("span",{className:"tag tag-radius tag-round tag-verde",children:"Se dio respuesta en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-amarillo",children:"Sin respuesta, en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-naranja",children:"Sin respuesta, fuera de tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-rojo",children:"Se dio respuesta fuera de tiempo"})]}),e.jsx("div",{className:"tags"})]}),e.jsx(S.Body,{children:e.jsx("div",{className:"panel panel-default",children:e.jsxs(Ce,{defaultActiveKey:"tab1",children:[e.jsx(v,{eventKey:"tab1",title:"Activos",children:e.jsxs(l,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:s=>M(s.target.value,"activos"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"2",children:"Sin respuesta, en tiempo"}),e.jsx("option",{value:"3",children:"Sin respuesta, fuera de tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{p("#activos-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(x,{id:"activos-table",data:ie,options:{language:j,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5]}}]},columns:[{data:"id",title:"Estatus",createdCell(s,a,u,b,r){p(s).css("background",u.color),p(s).css("color",u.color)},width:"5%"},{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"responsable",title:"Responsable",width:"10%"},{data:"proceso",title:"Proceso",width:"10%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{6:(s,a)=>e.jsxs("div",{className:"text-center",children:[a.respuesta>0&&a.finalizado===null&&m.rol==3?e.jsx(f,{href:route("viewRespOficio",{id:a.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})}):null,a.respuesta==0?e.jsx(f,{href:route("oficioResponder",{id:a.id}),style:{color:"white"},hidden:a.id_usuario!==null&&m.rol==3,children:e.jsx(i,{className:"btn-icon btn btn-warning",variant:m.rol==4&&(a.descripcion_rechazo_jefe!==null||a.descripcion_rechazo_final!==null)?"danger":"warning",title:"Responder al oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{d({...o,urlPdf:`imprime/pdf/0/${a.id}`,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),m.rol==3||m.rol==1?e.jsx(i,{className:"btn-icon btn ml-1",variant:a.descripcion_rechazo===null?"primary":"danger",title:a.descripcion_rechazo===null?"Asignar responsable":"Reasignar un responsable",onClick:()=>{me(a),se({...k,textoRechazo:a.descripcion_rechazo})},hidden:a.id_usuario!==null||a.respuesta>0,children:e.jsx("i",{className:"fa fa-male"})}):e.jsx(i,{className:"btn-icon btn ml-1",variant:"primary",title:"Rechazar responsabilidad",onClick:()=>{h.setData("id",a.id),_(!0)},disabled:a.respuesta!=0,children:e.jsx("i",{className:"fa fa-times"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{d({...o,urlPdf:a.archivo,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-eye"})})]})}})]})}),e.jsx(v,{eventKey:"tab2",title:"Histórico",children:e.jsxs(l,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:s=>M(s.target.value,"historico_vd"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{p("#historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(x,{id:"historico-table",data:te,options:{language:j,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5,6,7]}}]},columns:[{data:"id",title:"Estatus",createdCell(s,a,u,b,r){p(s).css("background",u.color),p(s).css("color",u.color)}},{data:"f_ingreso",title:"Fecha de ingreso"},{data:"des",title:"Ingreso"},{data:"destinatario",title:"Destinatario"},{data:"numero_oficio",title:"No. Oficio / Folio"},{data:"area",title:"Área"},{data:"proceso",title:"Proceso"},{data:"descripcion",title:"Breve descripción"},{data:"proceso",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{8:(s,a)=>e.jsxs("div",{className:"text-center",children:[e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...o,urlPdf:a.archivo_respuesta,extension:a.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(i,{className:"btn-icon btn btn-warning ml-1",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{d({...o,urlPdf:a.oficio_final,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),a.total_respuesta!==null?e.jsx(i,{className:"btn-icon ml-1",variant:"primary",onClick:()=>{H(a.id,"id_oficio")},title:"Ver archivos adjuntos de la respuesta oficio",children:e.jsx("i",{className:"fa fa-folder-open"})}):null,e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{d({...o,urlPdf:a.archivo,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-eye"})}),a.total_inicial!==null?e.jsx(i,{className:"btn-icon ml-1",variant:"warning",title:"Ver archivos del oficio inicial",onClick:()=>{H(a.id,"id_oficio_inicial")},children:e.jsx("i",{className:"fa fa-folder-open"})}):null,e.jsx(i,{className:"btn-icon ml-1",variant:"success",onClick:()=>{d({...o,idOfico:a.id}),O(!0)},title:"Ver línea de tiempo del oficio",children:e.jsx("i",{className:"fa fa-history"})})]})}})]})}),e.jsx(v,{eventKey:"tab3",title:"Informativos",children:e.jsx(l,{md:12,className:"table-responsive",children:e.jsx(x,{data:oe,options:{language:j,autoWidth:!1},columns:[{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{3:(s,a)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{d({...o,urlPdf:a.archivo,extension:"pdf"}),c(!0)},children:e.jsx("i",{className:"fa fa-eye"})})})}})})}),e.jsx(v,{eventKey:"tab4",title:"Oficios VD",children:e.jsxs(l,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{p("#vd-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(x,{id:"vd-table",data:re,options:{language:j,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"nombre_desti",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(s,a)=>e.jsxs("div",{className:"text-center",children:[a.revision>0&&a.finalizado===null&&m.rol==3&&a.id_usuario!==null?e.jsx(f,{href:route("viewRespNuevoOficio",{id:a.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})}):null,a.archivo_respuesta===null?null:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...o,urlPdf:a.archivo_respuesta,extension:a.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),m.rol==3&&a.id_usuario===null&&a.finalizado===null&&a.enviado===null?e.jsx(f,{href:route("nuevoOficio",{id:a.id}),style:{color:"white"},children:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:a.descripcion_rechazo_final!==null?"danger":"warning",title:"editar el oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):null,m.rol==4&&a.id_usuario!==null&&a.finalizado===null&&a.enviado===null&&a.revision===0?e.jsx(f,{href:route("nuevoOficio",{id:a.id}),style:{color:"white"},children:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:a.descripcion_rechazo_final!==null||a.descripcion_rechazo_jefe!==null?"danger":"warning",title:"editar el oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):null,e.jsx(f,{href:route("oficios.detalleNuevo",{id:a.id}),children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})}),e.jsx(v,{eventKey:"tab5",title:"Oficios VD - Histórico",children:e.jsxs(l,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{p("#vd-historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(x,{id:"vd-historico-table",data:ce,options:{language:j,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"nombre_desti",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(s,a)=>e.jsxs("div",{className:"text-center",children:[a.masivo==1?e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{d({...o,urlPdf:a.archivo_respuesta,extension:a.extension}),c(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}):e.jsx(f,{href:route("oficios.confirmaRecibidosNuevos",{id:a.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"warning",title:"Confirmaciones de recibido",children:[e.jsx("i",{className:"fa fa-handshake-o"})," "]})}),e.jsx(f,{href:route("oficios.detalleNuevo",{id:a.id}),children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})})]})})})]})})}),e.jsx(Ne,{urlPdf:o.urlPdf,show:U,tipo:o.extension,setShow:c}),e.jsx(ye,{showLinea:Y,setShowLinea:O,id:o.idOfico}),e.jsxs(A,{size:"xl",show:Z,onHide:()=>N(!1),children:[e.jsx(E,{children:e.jsx(P,{as:"h5",children:"Asignación de responsable"})}),e.jsxs("form",{onSubmit:L,children:[e.jsx(V,{children:e.jsxs(y,{children:[k.textoRechazo!==null?e.jsxs(l,{xs:12,children:[e.jsx(C.Label,{children:"Breve descripción del rechazo por parte del colaborador:"}),e.jsx("textarea",{className:"form-control",value:k.textoRechazo,rows:3,disabled:!0})]}):null,e.jsxs(l,{xs:12,sm:6,xl:4,children:[e.jsx(C.Label,{children:"Proceso al que impacta"}),e.jsx(W,{classNamePrefix:"Select",options:ee,ref:F,name:"proceso_impacta",className:n.errors.proceso_impacta?"inputError":"",defaultValue:n.data.proceso_impacta,onChange:s=>n.setData("proceso_impacta",s==null?void 0:s.value),placeholder:"Seleccione una opción"}),e.jsx(w,{className:"mt-1",message:n.errors.proceso_impacta})]}),e.jsxs(l,{xs:12,sm:6,xl:4,children:[e.jsx(C.Label,{children:"Usuario responsable"}),e.jsx(W,{classNamePrefix:"Select",options:J,name:"usuario",className:n.errors.usuario?"inputError":"",defaultValue:n.data.usuario,onChange:s=>n.setData("usuario",s==null?void 0:s.value),placeholder:"Seleccione una opción"}),e.jsx(w,{className:"mt-1",message:n.errors.usuario})]})]})}),e.jsxs(D,{children:[e.jsx(i,{variant:"secondary",onClick:()=>N(!1),children:"Cancelar"}),e.jsx(i,{variant:"primary",type:"submit",children:"Asignar responsable"})]})]})]}),e.jsxs(A,{show:G,onHide:()=>_(!1),children:[e.jsx(E,{children:e.jsx(P,{as:"h5",children:"Rechazar Oficio"})}),e.jsxs("form",{onSubmit:ue,children:[e.jsx(V,{children:e.jsx(y,{children:e.jsxs(l,{xs:12,children:[e.jsx(C.Label,{children:"Breve descripción del motivo del rechazo:"}),e.jsx("textarea",{className:h.errors.descripcion?"form-control inputError":"form-control",name:"descripcion",value:h.data.descripcion,onChange:s=>h.setData("descripcion",s.target.value),placeholder:"Máximo 500 caracteres",rows:2}),e.jsx(w,{className:"mt-1",message:h.errors.descripcion})]})})}),e.jsxs(D,{children:[e.jsx(i,{variant:"secondary",onClick:()=>_(!1),children:"Cancelar"}),e.jsx(i,{variant:"primary",type:"submit",children:"Rechazar oficio"})]})]})]}),e.jsxs(A,{size:"xl",show:q,onHide:()=>R(!1),children:[e.jsx(E,{children:e.jsx(P,{as:"h5",children:"Archivos adjuntos del oficio"})}),e.jsxs("form",{onSubmit:L,children:[e.jsx(V,{children:e.jsx(y,{children:e.jsx(l,{xs:12,children:e.jsx(x,{data:X,options:{language:j,autoWidth:!1},columns:[{data:"nombre",title:"Archivo"},{data:"id",title:"Ver"}],className:"display table-bordered  border-bottom ancho100",slots:{1:(s,a)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver archivo",onClick:()=>pe(a.url,a.tipo,a.extension),children:e.jsx("i",{className:"fa fa-eye"})})})}})})})}),e.jsx(D,{children:e.jsx(i,{variant:"secondary",onClick:()=>R(!1),children:"Cerrar"})})]})]})]})]})}export{$e as default};
