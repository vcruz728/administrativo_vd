import{r as c,X as V,G as b,j as e,S as A,x as L,A as T}from"./app-DiRkOQ83.js";import{A as _,p as $,g as H}from"./pageHeader-Dqbf_v8i.js";/* empty css                     */import{V as O}from"./VerPdf-CDPESMWW.js";import{S as v}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import P from"./InputError-B6pJpLUe.js";import{E as y,l as G,D as K}from"./es-MX-Cy3Xlz4a.js";import{F as q,D as I}from"./react-datepicker-DR_MAEWE.js";import{R as N,B as i,V as U}from"./index-Cu_1jRMP.js";import{C as a}from"./Col-DIGkerQj.js";import{C as u}from"./Card-BT9HD5VF.js";import{F as h}from"./Form-BdXddw8I.js";import{M as W,a as X,b as Y,c as J,d as Q}from"./Modal--lSp9NW5.js";import"./commonimages-Cf9OJsbq.js";import"./CloseButton-W2BzVG0t.js";import"./floating-ui.dom-yjPBAgC-.js";import"./ElementChildren-DbVbxqJs.js";y.use(K);function je({status:Z,id:n,archivos:g,oficio:r,destinatariosOficio:w}){const[C,d]=c.useState(!1),[S,x]=c.useState(!1),[D,f]=c.useState(""),[B,p]=c.useState("pdf"),F=V().props.auth.user,o=b({id:0,descripcion:""}),R=s=>{s.preventDefault(),v.fire({title:"¿Está seguro?",text:"Se notificará al colaborador para que vuelva a revisar el oficio.",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, estoy seguro",denyButtonText:"Cancelar",customClass:{container:"swalSuperior"}}).then(t=>{t.isConfirmed?o.put(route("rechazarRespNuevo")):o.cancel()})},m=b({id:r.id,fecha:r.fecha_envio||q}),z=s=>{s.preventDefault(),m.post(route("oficios.cambiaFechaNuevo"),{onSuccess:t=>{U("Correcto: Se actualizo la fecha de respuesta del oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})}})};function k(s){const[t,l,j]=s.split("-");return new Date(Number(t),Number(l)-1,Number(j))}const M=()=>{v.fire({title:"¿Está seguro?",text:"El oficio ya no se podrá editar y se marcará como finalizado",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, estoy seguro",denyButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&T.put(route("aceptRespNuevo",{id:n}))})},E=(s,t,l)=>{t==1?(f(s),d(!0),p(l)):window.open(s,"_blank")};return e.jsxs(_,{children:[e.jsxs(A,{children:[e.jsx("title",{children:"Revisión nuevo oficio"}),e.jsx("meta",{name:"Revision de nuevo oficio",content:"Revise la estructura de un nuevo oficio generado por la VD"})]}),e.jsxs(c.Fragment,{children:[e.jsx($,{titles:"Revisión de nuevo oficio",active:"Revisión de nuevo oficio",items:[{titulo:"Oficios",urlHeader:"/oficios/respuestas"}]}),e.jsx(N,{className:"d-flex justify-content-center",children:e.jsx(a,{lg:12,xl:6,children:e.jsxs(u,{children:[e.jsx(u.Header,{children:e.jsx(u.Title,{as:"h3",children:"Detalle del nuevo oficio"})}),e.jsxs(u.Body,{children:[r.masivo==1&&r.archivo.substring(r.archivo.length-3)!=="pdf"?e.jsx(a,{xs:12,style:{padding:40},children:e.jsxs("a",{className:"tag tag-radius tag-round tag-outline-danger",target:"_BLANK",href:H(`/files/${r.archivo}`),children:["Click para descargar el archivo",e.jsx("i",{className:"fa fa-file-pdf-o",style:{padding:6}})]})}):null,r.masivo==1?e.jsxs(e.Fragment,{children:[e.jsx(a,{xs:12,style:{padding:40},hidden:r.archivo.substring(r.archivo.length-3)!=="pdf",children:e.jsxs("span",{className:"tag tag-radius tag-round tag-outline-danger",onClick:()=>{f(r.archivo),p("pdf"),d(!0)},children:["Click para ver archivo",e.jsx("i",{className:"fa fa-file-pdf-o",style:{padding:6}})]})}),e.jsxs(a,{xs:12,className:"mb-5",children:[e.jsx(h.Label,{children:"Breve descripción del motivo del oficio"}),e.jsx("textarea",{className:"form-control",defaultValue:r.descripcion,disabled:!0,rows:4})]})]}):e.jsx(a,{xs:12,className:"mb-5",children:e.jsx(y,{data:w,options:{language:G,autoWidth:!1,ordering:!1,pageLength:5,lengthMenu:[[5,10,20,-1],[5,10,20,"Todos"]]},columns:[{data:"id",title:"Ver oficio",width:"10%"},{title:"Nombre",data:"nombre",width:"30%"}],className:"display table-bordered  border-bottom ancho100",slots:{0:(s,t)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver oficiosss",onClick:()=>{f(`imprime/nuevo/pdf/${n}/${t.id_usuario}/${t.tipo_usuario}`),p("pdf"),d(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})})})}})}),g.length>0?e.jsxs(e.Fragment,{children:[e.jsx(a,{xs:12,children:e.jsxs("table",{className:"table table-bordered table-hover table-striped",children:[e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:2,children:"Archivos adjuntos"})}),e.jsxs("tr",{children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Ver"})]})]}),e.jsx("tbody",{children:g.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.nombre}),e.jsx("td",{children:e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>E(s.url,s.tipo,s.extension),children:e.jsx("i",{className:"fa fa-eye"})})})]},s.id))})]})}),e.jsx(a,{xs:12,className:"mb-5 d-flex justify-content-end",children:e.jsxs("a",{href:route("oficios.downloadFilesNew",{id:n,tipo:"id_nuevo_oficio"}),target:"_BLANK",className:"btn btn-warning btn-lg mb-1",children:["Descargar todos los archivos adjuntos  ",e.jsx("i",{className:"fa fa-download"})]})})]}):null,r.comentario!==null?e.jsxs(a,{xs:12,className:"mb-5",children:[e.jsx(h.Label,{children:"Breve descripción del rechazo por parte de recepción documental:"}),e.jsx("textarea",{className:"form-control",value:r.comentario,rows:3,disabled:!0})]}):null,F.rol==5?e.jsxs("form",{onSubmit:z,children:[e.jsxs(a,{xs:4,children:[e.jsx(h.Label,{children:"Seleccione la fecha de respuesta del oficio:"}),e.jsx(I,{className:"form-control",selected:m.data.fecha?k(m.data.fecha):null,onChange:s=>{if(s){const t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),j=String(s.getDate()).padStart(2,"0");m.setData("fecha",`${t}-${l}-${j}`)}},dateFormat:"yyyy-MM-dd"})]}),e.jsx(a,{xs:4,className:"mt-5",children:e.jsx(i,{className:"btn btn-success ",type:"submit",children:"Guardar fecha"})}),e.jsx(a,{xs:12,className:"mb-5"})]}):null,e.jsxs("div",{className:"form-row",children:[e.jsx(a,{xs:12,xl:6,xxl:4,className:"d-flex justify-content-center",children:e.jsx(i,{className:"btn-lg mb-1",variant:"success",onClick:M,children:"Autorizar oficio"})}),e.jsx(a,{xs:12,xl:6,xxl:4,className:"d-flex justify-content-center",children:e.jsx(i,{className:"btn-lg mb-1",variant:"danger",onClick:()=>{x(!0),o.setData("id",n)},children:"Rechazar oficio"})}),r.masivo!=1?e.jsx(a,{xs:12,xl:12,xxl:4,className:"d-flex justify-content-center",children:e.jsx(L,{href:route("nuevoOficio",{id:n}),className:"btn btn-primary btn-lg",children:"Editar Oficio"})}):null]})]})]})})}),e.jsx(O,{urlPdf:D,show:C,setShow:d,tipo:B}),e.jsxs(W,{show:S,onHide:()=>x(!1),children:[e.jsx(X,{children:e.jsx(Y,{as:"h5",children:"Rechazar Oficio"})}),e.jsxs("form",{onSubmit:R,children:[e.jsx(J,{children:e.jsx(N,{children:e.jsxs(a,{xs:12,children:[e.jsx(h.Label,{children:"Breve descripción del motivo del rechazo:"}),e.jsx("textarea",{className:o.errors.descripcion?"form-control inputError":"form-control",name:"descripcion",value:o.data.descripcion,onChange:s=>o.setData("descripcion",s.target.value),placeholder:"Máximo 500 caracteres",rows:2}),e.jsx(P,{className:"mt-1",message:o.errors.descripcion})]})})}),e.jsxs(Q,{children:[e.jsx(i,{variant:"secondary",onClick:()=>x(!1),children:"Cancelar"}),e.jsx(i,{variant:"primary",type:"submit",children:"Rechazar oficio"})]})]})]})]})]})}export{je as default};
