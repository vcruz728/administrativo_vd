import{X as Z,r as a,G as k,j as e,S as $,x as N}from"./app-CfIZwGwU.js";import{A as G,p as U}from"./pageHeader-Bkp2TYq1.js";/* empty css                     */import{$ as d,E as f,l as h,D as X}from"./es-MX-LhFyKpEo.js";import{V as q}from"./VerPdf-CarIcMA9.js";import{R as V,B as i,c as Q}from"./index-BnXjDogV.js";import"./sweetalert2.esm.all-9Qm2jZ7z.js";import{L as Y,J as ee}from"./buttons.html5-B_9CvJJp.js";import{C as u}from"./Col-Qr9kuXVV.js";import{C as b}from"./Card-DKSS8lqU.js";import{T as se,a as p}from"./Tabs-Cg0F8UWU.js";import{M as te,a as ae,b as ie,c as oe,d as le}from"./Modal-BqIKmZ-n.js";import"./commonimages-B1RfzdlK.js";import"./CloseButton-Cfn6-q13.js";import"./ElementChildren-DDLPNzr_.js";window.JSZip=ee;f.use(X);function Ee({status:ne,oficios:x,usuariosSelect:re,procesos:ce,nuevos:j}){Z().props.auth.user;const[A,r]=a.useState(!1),[de,P]=a.useState(!1),[O,v]=a.useState(!1),[ue,fe]=a.useState(!1),[E,D]=a.useState([]),[F,g]=a.useState(!1),[me,he]=a.useState([]),[pe,xe]=a.useState({textoRechazo:""}),[o,l]=a.useState({urlPdf:"",extension:"",idOfico:0});a.useRef(null);const[T,S]=a.useState(),[R,y]=a.useState(),[H,L]=a.useState(),[M,B]=a.useState(),[K,W]=a.useState();a.useEffect(()=>{S((x||[]).filter(s=>s.archivo_respuesta===null&&s.id_area!="1").map(s=>({...s}))),y((x||[]).filter(s=>s.archivo_respuesta!==null&&s.id_area!="1").map(s=>({...s}))),L((x||[]).filter(s=>s.id_area==="1").map(s=>({...s})))},[x]),a.useEffect(()=>{B((j||[]).filter(s=>s.archivo_respuesta===null).map(s=>({...s}))),W((j||[]).filter(s=>s.archivo_respuesta!==null).map(s=>({...s})))},[j]);const _=k({id:"",proceso_impacta:"",usuario:""}),I=s=>{s.preventDefault(),_.post(route("oficioAsignaResponsable"),{onSuccess:J})};k({id:0,descripcion:""});const J=()=>{_.reset(),P(!1),Q("Correcto: Se asigno un responsable al oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})},w=async(s,t)=>{const m=await(await fetch(route("oficios.getArchivosAdjuntos",{id:s,tipo:t}),{method:"get"})).json();D(m.data),v(!0)},z=(s,t,c)=>{t==1?(l({...o,urlPdf:s,extension:c}),r(!0)):window.open(s,"_blank")},C=async(s,t)=>{const m=await(await fetch(route("oficios.getEstatus",{valor:s,tipo:t}),{method:"get"})).json();switch(t){case"activos":S((m.data||[]).filter(n=>n.archivo_respuesta===null&&n.id_area!=="1").map(n=>({...n})));break;case"historico_vd":y((m.data||[]).filter(n=>n.archivo_respuesta!==null&&n.id_area!=="1").map(n=>({...n})));break}};return e.jsxs(G,{children:[e.jsxs($,{children:[e.jsx("title",{children:"Mis oficios"}),e.jsx("meta",{name:"listado de mis oficios asignados",content:"Lista de oficios asignados"})]}),e.jsxs(a.Fragment,{children:[e.jsx(U,{titles:"Listado de oficios",active:"Listado de oficios",items:[]}),e.jsx(V,{children:e.jsx(u,{lg:12,md:12,children:e.jsxs(b,{children:[e.jsxs(b.Header,{className:"d-flex justify-content-between",children:[e.jsx(b.Title,{as:"h3",children:"Mis oficios asignados"}),e.jsxs("div",{className:"tags",children:[e.jsx("span",{className:"tag tag-radius tag-round tag-verde",children:"Se dio respuesta en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-amarillo",children:"Sin respuesta, en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-naranja",children:"Sin respuesta, fuera de tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-rojo",children:"Se dio respuesta fuera de tiempo"})]}),e.jsx("div",{className:"tags"})]}),e.jsx(b.Body,{children:e.jsx("div",{className:"panel panel-default",children:e.jsxs(se,{defaultActiveKey:"tab1",children:[e.jsx(p,{eventKey:"tab1",title:"Activos",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:s=>C(s.target.value,"activos"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"2",children:"Sin respuesta, en tiempo"}),e.jsx("option",{value:"3",children:"Sin respuesta, fuera de tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{d("#activos-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(f,{id:"activos-table",data:T,options:{language:h,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5]}}]},columns:[{data:"id",title:"Estatus",createdCell(s,t,c,m,n){d(s).css("background",c.color),d(s).css("color",c.color)},width:"5%"},{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"responsable",title:"Responsable",width:"10%"},{data:"proceso",title:"Proceso",width:"10%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{6:(s,t)=>e.jsxs("div",{className:"text-center",children:[t.respuesta==0?null:e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{l({...o,urlPdf:`imprime/pdf/0/${t.id}`,extension:"pdf"}),r(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:t.archivo,extension:"pdf"}),r(!0)},children:e.jsx("i",{className:"fa fa-eye"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"success",onClick:()=>{l({...o,idOfico:t.id}),g(!0)},title:"Ver línea de tiempo del oficio",children:e.jsx("i",{className:"fa fa-history"})})]})}})]})}),e.jsx(p,{eventKey:"tab2",title:"Histórico",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[e.jsx("div",{style:{width:"20%"},children:e.jsx("div",{className:"form-group",style:{margin:0},children:e.jsxs("select",{className:"form-control",onChange:s=>C(s.target.value,"historico_vd"),children:[e.jsx("option",{value:"0",children:"Todos"}),e.jsx("option",{value:"1",children:"Se dio respuesta en tiempo"}),e.jsx("option",{value:"4",children:"Se dio respuesta fuera de tiempo"})]})})}),e.jsx("button",{className:"btn btn-success",onClick:()=>{d("#historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})]}),e.jsx(f,{id:"historico-table",data:R,options:{language:h,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[1,2,3,4,5,6,7]}}]},columns:[{data:"id",title:"Estatus",createdCell(s,t,c,m,n){d(s).css("background",c.color),d(s).css("color",c.color)}},{data:"f_ingreso",title:"Fecha de ingreso"},{data:"des",title:"Ingreso"},{data:"destinatario",title:"Destinatario"},{data:"numero_oficio",title:"No. Oficio / Folio"},{data:"area",title:"Área"},{data:"proceso",title:"Proceso"},{data:"descripcion",title:"Breve descripción"},{data:"proceso",title:"Acciones"},{data:"asunto",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{8:(s,t)=>e.jsxs("div",{className:"text-center",children:[e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{l({...o,urlPdf:t.archivo_respuesta,extension:t.extension}),r(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(i,{className:"btn-icon btn btn-warning ml-1",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{l({...o,urlPdf:t.oficio_final,extension:"pdf"}),r(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),t.total_respuesta!==null?e.jsx(i,{className:"btn-icon ml-1",variant:"primary",onClick:()=>{w(t.id,"id_oficio")},title:"Ver archivos adjuntos de la respuesta oficio",children:e.jsx("i",{className:"fa fa-folder-open"})}):null,e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:t.archivo,extension:"pdf"}),r(!0)},children:e.jsx("i",{className:"fa fa-eye"})}),t.total_inicial!==null?e.jsx(i,{className:"btn-icon ml-1",variant:"warning",title:"Ver archivos del oficio inicial",onClick:()=>{w(t.id,"id_oficio_inicial")},children:e.jsx("i",{className:"fa fa-folder-open"})}):null,e.jsx(i,{className:"btn-icon ml-1",variant:"success",onClick:()=>{l({...o,idOfico:t.id}),g(!0)},title:"Ver línea de tiempo del oficio",children:e.jsx("i",{className:"fa fa-history"})})]})}})]})}),e.jsx(p,{eventKey:"tab3",title:"Informativos",children:e.jsx(u,{md:12,className:"table-responsive",children:e.jsx(f,{data:H,options:{language:h,autoWidth:!1},columns:[{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{3:(s,t)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:t.archivo,extension:"pdf"}),r(!0)},children:e.jsx("i",{className:"fa fa-eye"})})})}})})}),e.jsx(p,{eventKey:"tab4",title:"Oficios VD",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{d("#vd-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(f,{id:"vd-table",data:M,options:{language:h,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"nombre_desti",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(s,t)=>e.jsxs("div",{className:"text-center",children:[t.archivo_respuesta===null?null:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{l({...o,urlPdf:t.archivo_respuesta,extension:t.extension}),r(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(N,{href:route("oficios.detalleNuevo",{id:t.id}),children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})}),e.jsx(p,{eventKey:"tab5",title:"Oficios VD - Histórico",children:e.jsxs(u,{md:12,className:"table-responsive",children:[e.jsx("div",{className:"mb-3 d-flex justify-content-end",children:e.jsx("button",{className:"btn btn-success",onClick:()=>{d("#vd-historico-table").DataTable().button(".buttons-excel").trigger()},children:"Exportar a Excel"})}),e.jsx(f,{id:"vd-historico-table",data:K,options:{language:h,autoWidth:!1,buttons:[{extend:"excel",exportOptions:{columns:[0,1,2,3]}}]},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"oficio_respuesta",title:"Num Folio/Oficio",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"nombre_desti",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"},{data:"respuesta",title:"Respuesta",visible:!1,searchable:!0}],className:"display table-bordered  border-bottom ancho100",slots:{4:(s,t)=>e.jsxs("div",{className:"text-center",children:[t.masivo==1?e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{l({...o,urlPdf:t.archivo_respuesta,extension:t.extension}),r(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}):e.jsx(N,{href:route("oficios.confirmaRecibidosNuevos",{id:t.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"warning",title:"Confirmaciones de recibido",children:[e.jsx("i",{className:"fa fa-handshake-o"})," "]})}),e.jsx(N,{href:route("oficios.detalleNuevo",{id:t.id}),children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver detalle del oficio",children:e.jsx("i",{className:"fa fa-eye"})})})]})}})]})})]})})})]})})}),e.jsx(q,{urlPdf:o.urlPdf,show:A,tipo:o.extension,setShow:r}),e.jsx(Y,{showLinea:F,setShowLinea:g,id:o.idOfico}),e.jsxs(te,{size:"xl",show:O,onHide:()=>v(!1),children:[e.jsx(ae,{children:e.jsx(ie,{as:"h5",children:"Archivos adjuntos del oficio"})}),e.jsxs("form",{onSubmit:I,children:[e.jsx(oe,{children:e.jsx(V,{children:e.jsx(u,{xs:12,children:e.jsx(f,{data:E,options:{language:h,autoWidth:!1},columns:[{data:"nombre",title:"Archivo"},{data:"id",title:"Ver"}],className:"display table-bordered  border-bottom ancho100",slots:{1:(s,t)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver archivo",onClick:()=>z(t.url,t.tipo,t.extension),children:e.jsx("i",{className:"fa fa-eye"})})})}})})})}),e.jsx(le,{children:e.jsx(i,{variant:"secondary",onClick:()=>v(!1),children:"Cerrar"})})]})]})]})]})}export{Ee as default};
